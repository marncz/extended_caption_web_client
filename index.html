<html>
<link rel="stylesheet" type="text/css" href="css/style.css" />
<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />

<script src="js/jquery.js"></script>
<script src="js/ace/src-min-noconflict/ace.js"></script>
<script src="js/scheduler.js"></script>

<body>
  <div class="row wrapper">
      <div class="col-xs-1"></div>
      <div class="col-md-12">Extended Captions Logo</div>
  </div>
  <div class="row wrapper">
    <div class="col-xs-1"></div>
    <div class="col-md-6">
          <div id="video-container">
            <video id="video" width="640" height="480" controls>
              <source src="media/video-long.mp4" type="video/mp4">
            </video>
            <canvas id="draw-canvas"></canvas>
          </div>
    </div>
    <div class="col-md-4" id="container">
<div id="editor">1 -> 2
150,150,50,5

3 -> 4
150,150,25,5

5 -> 6
250,250,100,3

8 -> 9
50,50,80,5

15 -> 16
250,150,150,3
</div>
    </div>
  </div>
  </div>
</body>
<script>
    window.onload = function() {

    /* ACE editor init */
    var editor = ace.edit("editor");
    editor.setTheme("ace/theme/chrome");
    editor.setReadOnly(true);

    /* frameConverter initialization */
    var video = document.getElementById("video");
    video.addEventListener( "loadedmetadata", function (e) {
      var width = this.videoWidth,
          height = this.videoHeight,
          margin_top = (this.offsetHeight- height) / 2;

          /* Apply sizes and margins based on the actual video size */
          $("#draw-canvas").prop('width', width);
          $("#draw-canvas").prop('height', height);
          $("#draw-canvas").css("margin-top", margin_top + "px");
          $("#container").css("margin-top", margin_top + "px");

          var dispatcher = [];
          dispatcher[1] = {x: 150, y: 150, r: 50, f: 5, line: 1};
          dispatcher[3] = {x: 150, y: 150, r: 25, f: 5, line: 4};
          dispatcher[5] = {x: 250, y: 250, r: 100, f: 3, line: 7};
          dispatcher[8] = {x: 50, y: 50, r: 80, f: 5, line: 10};
          dispatcher[15] = {x: 350, y: 150, r: 150, f: 3, line: 13};

          /* Intialize scheduler */
          var canvas = document.getElementById('draw-canvas');
          var sched = new scheduler(canvas, dispatcher, editor);

          /* Mouse event for generating ripples when clicking on the canvas */
          $("#draw-canvas").click(function (e) {
              var posX = Math.ceil(e.pageX - $(this).offset().left),
                  posY = Math.ceil(e.pageY - $(this).offset().top);

              sched.drawRipple(posX, posY, 80, 5);
          });
    }, false );

  }
</script>
</html>
